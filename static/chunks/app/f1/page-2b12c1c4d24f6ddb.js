(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[290],{7351:function(e,t,r){Promise.resolve().then(r.bind(r,4728))},4728:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var a,s,n=r(7437),l=r(6691),c=r.n(l),i=r(2265);function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var o=function(e){return i.createElement("svg",d({xmlns:"http://www.w3.org/2000/svg",width:64,height:53,fill:"none"},e),a||(a=i.createElement("path",{fill:"#D9D9D9",d:"M15.25 52.128C5.776 52.128.784 44.832.784 32.16c0-14.08 7.04-24.832 21.632-32l4.864 9.984c-9.088 4.224-13.44 9.984-13.44 18.688l.384 13.056L6.93 31.776c2.304-1.792 5.248-3.328 8.32-3.328 6.4 0 11.648 4.352 11.648 11.264 0 7.552-4.864 12.416-11.648 12.416Zm35.84 0c-9.473 0-14.465-7.296-14.465-19.968 0-14.08 7.04-24.832 21.632-32l4.864 9.984c-9.088 4.224-13.44 9.984-13.44 18.688l.384 13.056-7.296-10.112c2.304-1.792 5.248-3.328 8.32-3.328 6.4 0 11.648 4.352 11.648 11.264 0 7.552-4.864 12.416-11.648 12.416Z"})))};function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var x=function(e){return i.createElement("svg",u({xmlns:"http://www.w3.org/2000/svg",width:63,height:52,fill:"none"},e),s||(s=i.createElement("path",{fill:"#D9D9D9",d:"M5.337 51.952.345 42.096c9.088-4.352 13.568-9.984 13.568-18.816l-.512-12.928 7.296 10.112c-2.176 1.792-5.248 3.2-8.192 3.2C5.977 23.664.73 19.312.73 12.4.73 4.848 5.721.112 12.505.112c9.472 0 14.336 7.296 14.336 19.712 0 14.08-7.04 25.088-21.504 32.128Zm35.84 0-4.992-9.856c9.088-4.352 13.568-9.984 13.568-18.816l-.512-12.928 7.296 10.112c-2.176 1.792-5.248 3.2-8.192 3.2-6.528 0-11.776-4.352-11.776-11.264C36.57 4.848 41.561.112 48.345.112c9.472 0 14.336 7.296 14.336 19.712 0 14.08-7.04 25.088-21.504 32.128Z"})))},g=r(4519),h=r(6693),p=r(4399),m=e=>{let{value:t,placeHolder:r}=e;return(0,n.jsx)("div",{className:t?"bg-[#FFF8E8] rounded-lg py-4 px-2 text-[#FEBB15]":"bg-[#FFF8E8] rounded-lg py-4 px-2 text-gray-Light",children:" ".concat(t||r)})},f=r(1859),v=r(4033);function j(){let[e,t]=(0,i.useState)(60),r=(0,v.useRouter)(),{handleAddProduct:a,order:s,handleUpdateProduct:l,handleResetOrder:d,handleSetOrderStage:u,handleSetPayStage:j}=(0,g.Z)(),b=s.currentOrderNumber,{isTakeout:y}=s,{orderNumber:N,burger:w,side:S,quantity:M,beverage:k,type:E}=s.products[b]||{},D=["주문을 도와드릴게요. 아래 주문 가이드에 맞춰 주문해주세요.","".concat(w," ").concat(E," ").concat(M,"개를 주문하셨군요. 기본 세트는 감자튀김과 콜라입니다."),"잘 못들었어요. 메뉴명과 세트 선택과 수량을 다시 말씀해주세요.","10초간 응답이 없으시면, 시작화면으로 이동합니다.","오랜 대기시간으로 60초 후 초기화면으로 이동합니다.","잘 못들었어요, 메뉴명과 세트 선택과 수량을 다시 말씀해주세요."],{startRecording:O,stopRecording:C,loading:Z}=(0,p.Z)(),{voiceStarted:R,startVoiceGuidance:B,stopVoiceGuidance:F}=(0,h.Z)(),_=(0,i.useRef)(!0),T=async()=>{let e=await O();e&&await a(e)};(0,i.useEffect)(()=>{u(0)},[]),(0,i.useEffect)(()=>{let e;return 0===s.orderStage&&B(D[s.orderStage],T),1===s.orderStage&&B(D[s.orderStage],()=>{setTimeout(()=>{j(0),r.push("/f2")},1e3)}),2===s.orderStage&&B(D[s.orderStage],T),3===s.orderStage&&B(D[s.orderStage]),4===s.orderStage&&B(D[s.orderStage],()=>{setTimeout(()=>{j(0),r.push("/")},1e3)}),5===s.orderStage&&B(D[s.orderStage],T),2!==s.orderStage&&5!==s.orderStage&&3!==s.orderStage&&t(60),e=setInterval(()=>{t(t=>(console.log(t),21===t&&u(4),31===t&&u(3),t>1)?t-1:(clearInterval(e),r.push("/"),0))},1e3),()=>clearInterval(e)},[s.orderStage]),(0,i.useEffect)(()=>{if(_.current){_.current=!1;return}console.log(s)},[w,s,M,r,E]);let H=e=>{let t=e.currentTarget.getAttribute("data-text");a({orderNumber:s.currentOrderNumber,burger:t,type:"세트",quantity:1,side:"감자튀김",beverage:"콜라",ingredients:{피클:0,토마토:0,양상추:0,양파:0,고기패티:0,치즈:0}})};return(0,n.jsxs)("div",{className:" w-full items-start",children:[(0,n.jsx)("div",{className:" flex justify-start",children:(0,n.jsx)("div",{className:" h-[300px] text-h1 font-bold pt-20 ml-10",children:"추천메뉴/주문"})}),(0,n.jsxs)("div",{className:" grid grid-cols-3 bg-gray-Light_2 mb-20 pt-10 pb-6",children:[(0,n.jsxs)("div",{"data-text":"빅맥",className:" col-span-1",onClick:e=>H(e),children:[(0,n.jsx)(c(),{src:"/burgers/bigMac.png",alt:"",width:585.95,height:407.62}),(0,n.jsxs)("div",{className:" flex-col text-center",children:[(0,n.jsx)("div",{className:" text-[50px] text-gray-Dark font-bold",children:"빅맥"}),(0,n.jsx)("div",{className:" text-[34px] text-gray-Medium",children:"단품 5,900원"}),(0,n.jsx)("div",{className:" text-[34px] text-gray-Medium",children:"세트 8,300원"})]})]}),(0,n.jsxs)("div",{"data-text":"불고기 버거",className:" col-span-1",onClick:e=>H(e),children:[(0,n.jsx)(c(),{src:"/burgers/bigMac.png",alt:"",width:585.95,height:407.62}),(0,n.jsxs)("div",{className:" flex-col text-center",children:[(0,n.jsx)("div",{className:" text-[50px] text-gray-Dark font-bold",children:"불고기 버거"}),(0,n.jsx)("div",{className:" text-[34px] text-gray-Medium",children:"단품 5,900원"}),(0,n.jsx)("div",{className:" text-[34px] text-gray-Medium",children:"세트 8,300원"})]})]}),(0,n.jsxs)("div",{"data-text":"베이컨 토마토 디럭스",className:" col-span-1",onClick:e=>H(e),children:[(0,n.jsx)(c(),{src:"/burgers/bigMac.png",alt:"",width:585.95,height:407.62}),(0,n.jsxs)("div",{className:" flex-col text-center",children:[(0,n.jsx)("div",{className:" text-[50px] text-gray-Dark font-bold ",children:"베이컨 토마토 디럭스"}),(0,n.jsx)("div",{className:" text-[34px] text-gray-Medium",children:"단품 5,900원"}),(0,n.jsx)("div",{className:" text-[34px] text-gray-Medium",children:"세트 8,300원"})]})]})]}),(0,n.jsx)("div",{className:" text-guide flex mx-12  mt-32 font-medium mb-40",children:(0,n.jsx)(f.Z,{text:D[s.orderStage],isLoading:Z})}),(0,n.jsxs)("div",{className:" text-[70px]",children:[(0,n.jsxs)("div",{className:" flex justify-center mx-14 my-4 space-x-10",children:[(0,n.jsx)("span",{className:" absolute left-10",children:(0,n.jsx)(o,{})}),(0,n.jsx)(m,{value:w,placeHolder:"메뉴"}),"세트"===E?(0,n.jsxs)("div",{className:" flex justify-center mx-14 space-x-10 relative",children:[(0,n.jsx)("div",{className:" absolute bottom-[130px] text-[50px] right-[140px]",children:"세트"}),(0,n.jsx)(m,{value:S,placeHolder:"사이드"}),(0,n.jsx)("div",{className:" text-center flex items-center",children:" /"}),(0,n.jsx)(m,{value:k,placeHolder:"음료 옵션"})]}):(0,n.jsx)(m,{value:E,placeHolder:"세트/단품"})]}),(0,n.jsxs)("div",{className:" flex justify-center items-center mx-14 space-x-10",children:["단품"===E&&k?(0,n.jsx)(m,{value:k,placeHolder:"음료 옵션"}):"",(0,n.jsx)(m,{value:M,placeHolder:"0"}),(0,n.jsx)("div",{children:" 개"}),(0,n.jsx)("div",{children:"부탁해요!"}),(0,n.jsx)("span",{className:" absolute right-10",children:(0,n.jsx)(x,{})})]}),(0,n.jsx)("div",{className:" flex justify-center mx-14 space-x-10"})]})]})}},4399:function(e,t,r){"use strict";var a=r(2265),s=r(2993),n=r(4519),l=r(8290);t.Z=()=>{let e=(0,s.T)(),t=(0,s.C)(e=>e.recording.loading),{handleAddProduct:r,order:c,handleUpdateProduct:i,handleResetOrder:d}=(0,n.Z)(),[o,u]=(0,a.useState)(!1),x=(0,a.useRef)(null),g=(0,a.useRef)(null),h=(0,a.useRef)(null),[p,m]=(0,a.useState)(null),f=(0,a.useRef)([]),v=(0,a.useRef)(null),j=async()=>new Promise(async(t,r)=>{e((0,l.K4)(!0)),speechSynthesis.cancel();try{let r=await navigator.mediaDevices.getUserMedia({audio:!0});g.current=r,x.current=new AudioContext;let a=x.current.createMediaStreamSource(r),s=x.current.createAnalyser();s.fftSize=1024,a.connect(s);let n=new Uint8Array(s.frequencyBinCount),c=0,i=setInterval(()=>{s.getByteTimeDomainData(n);let e=0;for(let t=0;t<n.length;t++){let r=(n[t]-128)/128;e+=r*r}let t=Math.sqrt(e/n.length);t>.02?c=0:c+=200,c>5e3&&(b(),clearInterval(i))},200);v.current=i;let d=new MediaRecorder(r);d.ondataavailable=e=>{e.data.size>0&&f.current.push(e.data)},d.onstop=()=>{let r=new Blob(f.current,{type:"audio/webm"});f.current=[],e((0,l.K4)(!1)),t(r)},d.start(),u(!0),h.current=d}catch(e){console.error("Error accessing the microphone:",e),r(e)}finally{}}),b=()=>{h.current&&(h.current.stop(),g.current&&g.current.getTracks().forEach(e=>e.stop()),u(!1),null!==v.current&&(clearInterval(v.current),v.current=null))},y=async t=>{e((0,l.K4)(!0));let r=new FormData;r.append("audio_file",t,"audio.webm");try{let e=await fetch("https://sr-kiosk-api-shs2783.koyeb.app/api/stt/menu",{method:"POST",headers:{accept:"application/json"},body:r});if(e.ok){let t=await e.json();return t}}catch(e){console.log(e)}finally{e((0,l.K4)(!1))}};return{recording:o,audioBlob:p,startRecording:j,stopRecording:b,sendDataToServer:y,loading:t}}},8290:function(e,t,r){"use strict";r.d(t,{K4:function(){return c}});var a=r(64);let s=(0,a.oM)({name:"recording",initialState:{recording:!1,audioBlob:null,loading:!1},reducers:{setRecording:(e,t)=>{e.recording=t.payload},setAudioBlob:(e,t)=>{e.audioBlob=t.payload},setLoading:(e,t)=>{e.loading=t.payload}}}),{setRecording:n,setAudioBlob:l,setLoading:c}=s.actions;t.ZP=s.reducer}},function(e){e.O(0,[713,881,758,567,971,596,744],function(){return e(e.s=7351)}),_N_E=e.O()}]);