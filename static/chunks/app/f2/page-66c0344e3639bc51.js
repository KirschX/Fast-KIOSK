(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[403],{9772:function(e,t,s){Promise.resolve().then(s.bind(s,2252))},2252:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return b}});var n,r=s(7437),a=s(4033),c=s(4519);let l={빅맥:"bigMac","불고기 버거":"bulgogi","베이컨 토마토 디럭스":"BTD"},i=e=>{switch(e){case"피클":return"pickle";case"양파":return"onion";case"토마토":return"tomato";case"양상추":return"cabbage";case"고기패티":return"patty";case"치즈":return"cheese";default:throw Error("Unknown option: ".concat(e))}},o=e=>l[e],d=(e,t)=>t.reduce((t,s)=>{let n=0,r=o(s.burger);return r&&(n+="단품"===s.type?e.burger[r][0]*s.quantity:e.burger[r][1]*s.quantity),t+(n+=Object.entries(s.ingredients).reduce((t,s)=>{let[n,r]=s;return 0===r?t:n?t+e.options[i(n)]*r:t},0))},0),u=(e,t)=>t.map(t=>{let s=0,n=o(t.burger);return n?s+=("단품"===t.type?e.burger[n][0]*t.quantity:e.burger[n][1]*t.quantity)+Object.entries(t.ingredients).reduce((t,s)=>{let[n,r]=s;return 0===r?t:t+e.options[i(n)]*r},0):0});var p=s(2265),x=s(6693);function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e}).apply(this,arguments)}var m=function(e){return p.createElement("svg",h({xmlns:"http://www.w3.org/2000/svg",width:68,height:68,fill:"none"},e),n||(n=p.createElement("path",{fill:"#000",d:"M68 12.367 55.633 0 34 21.633 12.367 0 0 12.367 21.633 34 0 55.633 12.367 68 34 46.367 55.633 68 68 55.633 46.367 34 68 12.367Z"})))},g=s(1859),f=s(4399);function b(){let e=(0,a.useRouter)(),{handleAddProduct:t,order:s,handleUpdateProduct:n,handleResetOrder:l,handleRemoveProduct:i,handleSetOrderStage:o,handleSetCurrentOrderNumber:h,handleSetPayStage:b,handleSetTargetOrderNumber:j}=(0,c.Z)(),{startRecording:v,stopRecording:y,loading:N}=(0,f.Z)(),{voiceStarted:w,startVoiceGuidance:k,stopVoiceGuidance:_}=(0,x.Z)(),{menuPrices:C,products:O,payStage:q}=s,D=d(s.menuPrices,s.products),S=u(s.menuPrices,s.products),E=["결제하실 금액은 ".concat(D,"원 입니다."),"결제를 원하시면 결제하기 라고 말씀하시거나 버튼을 눌러주세요."],M=["결제하실 금액은 ".concat(D,"원 입니다."),(0,r.jsxs)(r.Fragment,{children:["결제를 원하시면 ",(0,r.jsx)("span",{className:"text-WineBerry",children:"결제하기"})," 라고 말씀하시거나 버튼을 눌러주세요."]})],B=async()=>{let t=await v();if(t){let s=new FormData;s.append("audio_file",t,"audio.webm");let n=await fetch("https://sr-kiosk-api-shs2783.koyeb.app/api/stt/pay",{method:"POST",headers:{accept:"application/json"},body:s}),r=await n.json();console.log(r),r.pay&&e.push("/f3")}};return(0,p.useEffect)(()=>{0===q&&0!==O.length&&k(E[q],()=>{b(1)}),1===q&&k(E[q],()=>{B()})},[q]),(0,r.jsxs)("div",{className:" w-full items-start",children:[(0,r.jsx)("div",{className:" flex justify-start mb-20",children:(0,r.jsx)("div",{className:" h-[300px] text-h1 font-bold pt-20 ml-10",children:"주문내역"})}),(0,r.jsxs)("div",{className:" grid grid-cols-11 text-[50px] mx-10 text-center",children:[(0,r.jsx)("div",{className:" col-span-3",children:"메뉴"}),(0,r.jsx)("div",{className:" col-span-3",children:"구성변경"}),(0,r.jsx)("div",{className:" col-span-2",children:"가격"}),(0,r.jsx)("div",{className:" col-span-2",children:"수량변경"}),(0,r.jsx)("div",{className:" col-span-1",children:"취소"})]}),(0,r.jsx)("div",{className:" col-span-4 border-b-[1px] mb-20",children:" "}),s.products.map((t,a)=>(0,r.jsxs)("div",{className:" grid grid-cols-11 text-[50px] mx-10 mb-10 text-center items-center",children:[(0,r.jsx)("div",{className:" col-span-3",children:(0,r.jsxs)("div",{className:" flex-col",children:[(0,r.jsx)("div",{className:" font-bold",children:t.burger}),(0,r.jsx)("div",{className:" text-[36px] text-gray-Light overflow-hidden",children:(()=>{let e=Object.keys(t.ingredients).filter(e=>t.ingredients[e]>0),s=e.join(", ");return s.length>10?s.slice(0,10)+"...":s})()}),(0,r.jsx)("div",{className:" text-[36px] text-gray-Light",children:"".concat(t.side,", ").concat(t.beverage)})]})}),(0,r.jsx)("div",{className:" col-span-3",children:(0,r.jsxs)("div",{className:" flex-col space-y-4",children:[(0,r.jsxs)("div",{onClick:()=>{j(a),e.push("f2/side")},className:" rounded-[40px] p-4 border border-black",children:[(0,r.jsx)("span",{children:"사이드/음료"}),(0,r.jsx)("span",{className:" text-[32px] relative left-2",children:"변경"})]}),(0,r.jsxs)("div",{onClick:()=>{j(a),e.push("f2/ingredients")},className:" rounded-[40px] p-4 border border-black",children:[(0,r.jsx)("span",{children:"재료"}),(0,r.jsx)("span",{className:" text-[32px] relative left-2",children:"변경"})]})]})}),(0,r.jsx)("div",{className:" col-span-2",children:"".concat(S[a],"원")}),(0,r.jsxs)("div",{className:" col-span-2 space-x-6 font-bold",children:[(0,r.jsx)("span",{onClick:()=>{console.log(+t.quantity-1),n(a,{quantity:+t.quantity-1})},className:" text-[#D3D2D2] text-[120px]",children:"-"}),(0,r.jsx)("span",{className:" text-[80px] relative bottom-[8px]",children:t.quantity}),(0,r.jsx)("span",{onClick:()=>{console.log(t),console.log(s.products),n(a,{quantity:+t.quantity+1})},className:" text-[#D3D2D2] text-[120px]",children:"+"})]}),(0,r.jsx)("div",{onClick:()=>{i(a),h(s.currentOrderNumber-1)},className:" col-span-1",children:(0,r.jsx)("div",{className:" flex justify-center",children:(0,r.jsx)(m,{})})})]},a)),(0,r.jsx)("div",{className:" col-span-4 border-b-[1px]",children:" "}),(0,r.jsx)("div",{className:" flex justify-end p-4 text-guide font-bold mb-40",children:"총 ".concat(D,"원")}),(0,r.jsx)("div",{className:" mb-20",children:(0,r.jsx)(g.Z,{isLoading:N,children:M[s.payStage]})}),(0,r.jsxs)("div",{className:" text-h2 font-bold text-center",children:[(0,r.jsxs)("div",{className:" flex mx-20 space-x-20",children:[(0,r.jsx)("div",{onClick:()=>{o(0),h(s.currentOrderNumber+1),e.push("/f1")},className:" w-1/2 rounded-[80px] bg-gray-Light_2 text-gray-Medium p-20 shadow-[5px_8px_8px_0px_rgba(0,0,0,0.15)]",children:"추가 주문"}),(0,r.jsx)("div",{onClick:()=>{e.push("/f3")},className:" w-1/2 rounded-[80px] bg-LightningYellow text-white p-20 shadow-[5px_8px_8px_0px_rgba(0,0,0,0.15)]",children:"결제하기"})]}),(0,r.jsx)("div",{className:" flex ",onClick:()=>{l(),o(0),e.push("/f1")},children:(0,r.jsx)("div",{className:"w-full rounded-[80px] bg-gray-Light_2 text-gray-Medium p-4 mx-20 mt-20 shadow-lg",children:"다시 주문"})})]})]})}},4399:function(e,t,s){"use strict";var n=s(2265),r=s(2993),a=s(4519),c=s(8290);t.Z=()=>{let e=(0,r.T)(),t=(0,r.C)(e=>e.recording.loading),{handleAddProduct:s,order:l,handleUpdateProduct:i,handleResetOrder:o}=(0,a.Z)(),[d,u]=(0,n.useState)(!1),p=(0,n.useRef)(null),x=(0,n.useRef)(null),h=(0,n.useRef)(null),[m,g]=(0,n.useState)(null),f=(0,n.useRef)([]),b=(0,n.useRef)(null),j=async()=>new Promise(async(t,s)=>{e((0,c.K4)(!0)),speechSynthesis.cancel();try{let s=await navigator.mediaDevices.getUserMedia({audio:!0});x.current=s,p.current=new AudioContext;let n=p.current.createMediaStreamSource(s),r=p.current.createAnalyser();r.fftSize=1024,n.connect(r);let a=new Uint8Array(r.frequencyBinCount),l=0,i=setInterval(()=>{r.getByteTimeDomainData(a);let e=0;for(let t=0;t<a.length;t++){let s=(a[t]-128)/128;e+=s*s}let t=Math.sqrt(e/a.length);t>.02?l=0:l+=200,l>5e3&&(v(),clearInterval(i))},200);b.current=i;let o=new MediaRecorder(s);o.ondataavailable=e=>{e.data.size>0&&f.current.push(e.data)},o.onstop=()=>{let s=new Blob(f.current,{type:"audio/webm"});f.current=[],e((0,c.K4)(!1)),t(s)},o.start(),u(!0),h.current=o}catch(e){console.error("Error accessing the microphone:",e),s(e)}finally{}}),v=()=>{h.current&&(h.current.stop(),x.current&&x.current.getTracks().forEach(e=>e.stop()),u(!1),null!==b.current&&(clearInterval(b.current),b.current=null))},y=async t=>{e((0,c.K4)(!0));let s=new FormData;s.append("audio_file",t,"audio.webm");try{let e=await fetch("https://sr-kiosk-api-shs2783.koyeb.app/api/stt/menu",{method:"POST",headers:{accept:"application/json"},body:s});if(e.ok){let t=await e.json();return t}}catch(e){console.log(e)}finally{e((0,c.K4)(!1))}};return{recording:d,audioBlob:m,startRecording:j,stopRecording:v,sendDataToServer:y,loading:t}}},8290:function(e,t,s){"use strict";s.d(t,{K4:function(){return l}});var n=s(64);let r=(0,n.oM)({name:"recording",initialState:{recording:!1,audioBlob:null,loading:!1},reducers:{setRecording:(e,t)=>{e.recording=t.payload},setAudioBlob:(e,t)=>{e.audioBlob=t.payload},setLoading:(e,t)=>{e.loading=t.payload}}}),{setRecording:a,setAudioBlob:c,setLoading:l}=r.actions;t.ZP=r.reducer},4033:function(e,t,s){e.exports=s(8165)}},function(e){e.O(0,[713,881,567,971,596,744],function(){return e(e.s=9772)}),_N_E=e.O()}]);